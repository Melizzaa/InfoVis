
<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
   <title>InfoVis</title>
   <!-- Latest compiled and minified CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
   <link rel="stylesheet" href="style.css">

   <script type="text/javascript" src="d3/d3.js" charset="utf-8"></script>

   <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
   <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
   </head>
   <body>
      <div class="container">
         <nav class="navbar navbar-default">
            <div class="container-fluid">
               <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                     <span class="sr-only">Toggle navigation</span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                     <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand" href="/">InfoVis</a>
               </div>
               <ul class="nav navbar-nav">
                  <li><a href="/">About Us</a></li>
                  <li><a href="/">Help</a></li>
               </ul>
               <!--/.nav-collapse -->
            </div>
            <!--/.container-fluid -->
         </nav>
         <div class="jumbotron">
            <h1>An interactive housing guide </h1>
            <h2>For those unknown to Amsterdam</h2>  
         </div>
         <div class="row">
            <div class="col-md-3 text-center">
              <figure><img src="http://www.echelonna.com/start_students.png" height="42" width="42"/></figure>
              <div class="area">Legenda Area</div>
            </div>
            <div class="col-md-6 text-center">
               <div class="area">Map Area</div>
            </div>
            <div class="col-md-3 text-center">
               <div class="area">Chart area</div>
            </div>
        </div>
        <div class="row">
          <div class="col-md-8">
            <div id="meteo1"></div>
          </div>
        </div>
     </div><!-- Container -->

     <script type="text/javascript">
  // 5 transform the data
  //var avgTempsPerMonth = [];
  var avgTemps2015 = new Array(12);
  var totalTempsPerMonth2015 = new Array(12);
  var daysPerMonth2015 = new Array(12);
  for (var i = 0; i < avgTemps2015.length; i++) {
    avgTemps2015[i] = 0;
    totalTempsPerMonth2015[i] = 0;
    daysPerMonth2015[i] = 0;
  };
  var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

  function calcAvg() {
    for (var i = 0; i < 12; i++) {
      avgTemps2015[i] = (totalTempsPerMonth2015[i] / daysPerMonth2015[i]).toFixed(1);
    }
  }

  function maxRange(max) {
    if (max % 5 === 0) {
      return max+5;
    } else {
      return max+5-(max % 5);
    };
  }

  var year = 2015;


  d3.csv("meteo.csv", function(data) {
    var thisMonth = 1;
    var totalThisMonth = 0;
    var totalDaysThisMonth = 1;
    for (var i = 0; i < data.length; i++) {
      if (data[i].year == year) {
        var index = parseInt(data[i].month)-1;
        totalTempsPerMonth2015[index] += parseInt(data[i].temperature) / 10;
        daysPerMonth2015[index]++;


        // if (parseInt(data[i].month) != thisMonth) { //maand voorbij
        //   avgTemps2015[thisMonth-1] = (totalThisMonth / totalDaysThisMonth);
        //   console.log(avgTemps2015[thisMonth-1]);
        //   thisMonth = parseInt(data[i].month);
        //   totalDaysThisMonth = 0;
        //   totalThisMonth = 0;
        // }
        //totalThisMonth += parseInt(data[i].temperature) / 10;
        //totalDaysThisMonth += 1;
      }
    };
    calcAvg();
    //console.log(avgTemps2015);
    data = avgTemps2015;
    var h = 300;
    var w = 500;
    var offset = 16; // verhoging voor de x-as
    var padding = 30; //links van de y-as
    var barPadding = 1;
    var maxValue = Math.max.apply(Math, data);

    var yScale = d3.scale.linear()
    .domain([0, maxRange(maxValue)])
    .range([h, offset+10]);

    //console.log(yScale(5));

    var svg = d3.select("#meteo1")
    .append("svg")
    .attr("width", w)
    .attr("height", h);

    svg.selectAll("rect")
    .data(data)
    .enter()
    .append("rect")
    .attr("x", function(d, i) {
      return i * ((w-padding) / data.length)+ padding;
    })
    .attr("y", function(d) {
      return yScale(d)-offset; // y coordinaat vanaf boven gezien.
    })
    .attr("width", (w-padding) / data.length - barPadding)
    .attr("height", function(d) {
      return h-(yScale(d));
    })
    .attr("fill", function(d) {
      //return "rgb(" + (200*(d/maxValue)).toFixed(0) + ", " + (200*(d/maxValue)).toFixed(0) + ", " + (200*(d/maxValue)).toFixed(0) + ")";
      return "rgb(254,165,1)";
    });

  // Values
  svg.selectAll("text.values")
  .data(data)
  .enter()
  .append("text")
  .text(function(d) {
    return d;
  })
  .attr("text-anchor", "middle")
  .attr("x", function(d, i) {
    return i * ((w-padding) / data.length) + (w / data.length - barPadding) / 2 + padding - 1; //midden van bar //
  })
  .attr("y", function(d) {
    return yScale(d)-offset+14;
  })
  .attr("font-family", "sans-serif")
  .attr("font-size", "11px")
  .attr("fill", "black")

  // Months
  svg.selectAll("text.monts")
  .data(months)
  .enter()
  .append("text")
  .text(function(d) {
    return d;
  })
  .attr("text-anchor", "middle")
  .attr("x", function(d, i) {
    return i * ((w-padding) / data.length) + (w / data.length - barPadding) / 2 + padding; //midden van bar
  })
  .attr("y", function(d) {
    return h-4; //anders vallen sommige letters er van af
  })
  .attr("font-family", "sans-serif")
  .attr("font-size", "12px")
  .attr("fill", "black");

  // Y AXIS
  //Define Y axis
  var yAxis = d3.svg.axis()
  .scale(yScale)
  .orient("left")
  .ticks(5);

  //Create Y axis
  svg.append("g")
  .attr("class", "axis")
  .attr("transform", "translate(" + padding + ",-"+offset+")")
  .call(yAxis);

});
</script>
     <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
     <!-- Include all compiled plugins (below), or include individual files as needed -->
     <!-- Latest compiled and minified JavaScript -->
     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  </body>
  </html>
